# ============================================
# HalloWa.id Backend Environment Variables
# ============================================
# Version: 3.0.0 (Local Redis Migration)
# Last Updated: 2025-11-18
# Copy this to .env and fill with your actual values
#
# üìã Quick Setup Checklist:
# [ ] 1. Server ID (REQUIRED for multi-server)
# [ ] 2. Supabase credentials (REQUIRED)
# [ ] 3. Local Redis URL (REQUIRED)
# [ ] 4. Internal API key (REQUIRED)
# [ ] 5. Monitoring credentials (OPTIONAL)
#
# üìö For detailed setup, see: docs/REDIS_LOCAL_MIGRATION.md
# ============================================

# ============================================
# üÜî SERVER IDENTIFICATION (Multi-Server)
# ============================================
# REQUIRED for multi-server deployments to prevent device conflicts
# Each server instance MUST have a unique SERVER_ID
#
# Format: Valid UUID (v4 or v5)
# Generate UUID: https://www.uuidgenerator.net/ or use `uuidgen` command
# Examples:
#   550e8400-e29b-41d4-a716-446655440000
#   6ba7b810-9dad-11d1-80b4-00c04fd430c8
#
# If empty, system will auto-generate deterministic UUID v5 from:
# 1. RAILWAY_STATIC_URL (Railway deployments)
# 2. RAILWAY_SERVICE_NAME (Railway service name)
# 3. HOSTNAME (VPS/Docker/Dokploy)
# 4. OS hostname (fallback)
# 5. Random UUID v4 (last resort)
#
# ‚ö†Ô∏è IMPORTANT:
# - Auto-generated UUIDs are deterministic (same hostname = same UUID)
# - For multi-server: Ensure each server has unique hostname OR set explicit SERVER_ID
# - After first deployment, note the UUID from logs to add server to database via Admin Panel
SERVER_ID=

# ============================================
# DATABASE - Supabase PostgreSQL (REQUIRED)
# ============================================
# Get from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here

# ============================================
# REDIS - Local Redis (REQUIRED)
# ============================================
# Local Redis connection for all operations:
# - QR codes & pairing codes (temporary data)
# - Rate limiting (distributed)
# - Cache (application cache)
# - BullMQ queue (broadcast queue management)
#
# Format: redis://[username]:[password]@[host]:[port]/[db]
#
# üìç For Railway Redis:
#   Get from Railway > Redis Service > Connect
#   Example: redis://default:password@redis.railway.internal:6379
#
# üìç For Dokploy Redis:
#   Get from Dokploy > Redis Service > Connection Details
#   Example: redis://default:dzj7CABAcay5bef@hallowa-redis-baileys-vncaut:6379
#
# üìç For VPS Redis (localhost):
#   Example: redis://localhost:6379
#   Or with password: redis://default:your_password@localhost:6379
#
# ‚ö†Ô∏è IMPORTANT: This is a single connection for ALL Redis operations
#    No need for separate REST API credentials!
REDIS_URL=redis://default:password@localhost:6379

# ============================================
# SERVER CONFIGURATION
# ============================================
# Port for main service (auto-set by Railway, default: 3000)
PORT=3000

# Environment (development, staging, production)
NODE_ENV=production

# Logging Level (error, warn, info, debug)
LOG_LEVEL=info

# ============================================
# SECURITY (REQUIRED)
# ============================================
# Internal API Key for Edge Function ‚Üî Railway communication
# This key authenticates requests from Supabase Edge Functions to Railway Service
#
# Generate with: openssl rand -base64 32
# Or online: https://generate-random.org/api-key-generator
#
# ‚ö†Ô∏è CRITICAL:
# - Minimum 32 characters for security
# - Must match INTERNAL_API_KEY in Supabase Edge Function secrets
# - Keep this secret! Never commit to git
# - Without this, Edge Functions cannot communicate with Railway Service
#
# Example:
# INTERNAL_API_KEY=K8Jd9mP2nQ5rT7vX1wZ3yA6bC8eF0gH4iJ7kL9mN2oP5qR8sT0uV3wX6yZ9aB1cD4
INTERNAL_API_KEY=

# ============================================
# MONITORING & DASHBOARD (OPTIONAL)
# ============================================
# BullMQ Dashboard Configuration
# Access dashboard at: http://localhost:3001/admin/queues

# Port for monitoring dashboard (separate from main app)
MONITORING_PORT=3001

# Dashboard authentication credentials
# ‚ö†Ô∏è CHANGE THESE IN PRODUCTION!
ADMIN_USERNAME=admin
ADMIN_PASSWORD=your_secure_admin_password_here

# ============================================
# OPTIONAL: Session Configuration
# ============================================
# Session timeout in milliseconds (default: 1 hour)
# SESSION_TIMEOUT=3600000

# ============================================
# MIGRATION NOTES:
# ============================================
#
# üéâ Simplified Redis Configuration!
# - Old setup required 3 different credentials (REST URL, REST TOKEN, TCP URL)
# - New setup only needs 1: REDIS_URL
#
# ‚úÖ Single Redis connection handles:
#    - Session management (QR codes, pairing codes)
#    - Rate limiting
#    - Application cache
#    - BullMQ queue (broadcast processing)
#
# üöÄ Benefits:
#    - Lower latency (TCP native vs HTTP REST)
#    - Better performance (no REST API overhead)
#    - Cost savings (local Redis is free)
#    - Simpler configuration (1 variable vs 3)
#
# üìñ For detailed migration guide, see:
#    railway-service/docs/REDIS_LOCAL_MIGRATION.md
#
# ============================================
# REDIS SETUP EXAMPLES:
# ============================================
#
# üê≥ Docker Compose:
#   services:
#     redis:
#       image: redis:7-alpine
#       ports:
#         - "6379:6379"
#   REDIS_URL=redis://localhost:6379
#
# üöÇ Railway:
#   1. Add Redis service from marketplace
#   2. Copy connection string from service details
#   REDIS_URL=redis://default:xxx@redis.railway.internal:6379
#
# üì¶ Dokploy:
#   1. Create Redis service
#   2. Copy connection URL from service page
#   REDIS_URL=redis://default:xxx@your-redis-host:6379
#
# üñ•Ô∏è VPS (systemd):
#   1. Install: apt install redis-server
#   2. Start: systemctl start redis
#   3. Set password in /etc/redis/redis.conf
#   REDIS_URL=redis://localhost:6379
#
# ============================================
